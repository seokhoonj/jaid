
.JAID_ENV <- NULL
.onLoad <- function(libname, pkgname) {
  .JAID_ENV <<- new.env()
  assign(".DATE_FORMAT", "^\\d{4}(0?[13578]|1[02])(0?[1-9]|[12][0-9]|3[01])$|^\\d{4}(0?[469]|11)(0?[1-9]|[12][0-9]|30)$|^\\d{4}(02)(0?[1-9]|[12][0-9])$|^\\d{4}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01])$|^\\d{4}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30)$|^\\d{4}-(02)-(0?[1-9]|[12][0-9])$|^\\d{4}/(0?[13578]|1[02])/(0?[1-9]|[12][0-9]|3[01])$|^\\d{4}/(0?[469]|11)/(0?[1-9]|[12][0-9]|30)$|^\\d{4}/(02)/(0?[1-9]|[12][0-9])$|^\\d{4}\\.(0?[13578]|1[02])\\.(0?[1-9]|[12][0-9]|3[01])$|^\\d{4}\\.(0?[469]|11)\\.(0?[1-9]|[12][0-9]|30)$|^\\d{4}\\.(02)\\.(0?[1-9]|[12][0-9])$",
         envir = .JAID_ENV)
  op <- options()
  op.jaid <- list(
    jaid.eps = 1e-8,
    jaid.scipen = 14,
    jaid.guess_max = 21474836
  )
  toset <- !(names(op.jaid) %in% names(op))
  if (any(toset)) options(op.jaid[toset])
  invisible()
}

.onUnload <- function(libpath) {
  library.dynam.unload("jaid", libpath)
}
