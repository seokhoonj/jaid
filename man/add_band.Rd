% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cut.R
\name{add_band}
\alias{add_band}
\title{Create binned "bands" from a numeric column (class-preserving)}
\usage{
add_band(
  df,
  num_var,
  breaks,
  interval = 5,
  right = FALSE,
  col_nm,
  cutoff = FALSE,
  label_style = c("close", "open.start", "open", "open.end")
)
}
\arguments{
\item{df}{A data frame, tibble, or data.table.}

\item{num_var}{Unquoted column name of the numeric variable to bin (e.g., \code{age}).}

\item{breaks}{Optional numeric vector of cut points \strong{in ascending order}.
If missing, breaks are generated from the observed range using
\code{interval}. (Note: unlike \code{\link[base:cut]{base::cut()}}, a single integer here is
\strong{not} interpreted as “number of bins”.)}

\item{interval}{Integer width for bins when \code{breaks} is missing. Default \code{5}.}

\item{right}{Logical; passed to \code{\link[base:cut]{base::cut()}}. If \code{TRUE}, intervals are
right-closed \verb{(a, b]}; if \code{FALSE} (default), left-closed \verb{[a, b)}.}

\item{col_nm}{Optional name for the new band column. Default is
\code{"<num_var>_band"}.}

\item{cutoff}{Logical; if \code{TRUE}, the upper break is forced to the
observed maximum + 1, so the top band ends right above the maximum.
Default \code{FALSE}.}

\item{label_style}{Label style for the band levels; one of:
\itemize{
\item \code{"close"} (default): \code{"a-b"} for all bands
\item \code{"open"}: first band \code{"-b"}, last band \code{"a-"}
\item \code{"open.start"}: first band \code{"-b"} only
\item \code{"open.end"}: last band \code{"a-"} only
}}
}
\value{
An object of the \strong{same class as \code{df}}, with an ordered factor
column appended (at \code{col_nm}). The new column is placed immediately
after \code{num_var}.
}
\description{
Convert a numeric variable into ordered bands (factor levels) using
pretty, human-readable labels. Works with \code{data.frame}, tibble, or
data.table. Internally converts to \code{data.table} (via
\code{\link[=ensure_dt_env]{ensure_dt_env()}}) to compute efficiently, then restores the original
class on return.
}
\details{
\itemize{
\item When \code{breaks} is missing, the function computes a lower bound at
\code{floor(min(num_var)/interval) * interval} and an upper bound at
\code{ceiling(max(num_var)/interval) * interval} (or \code{max(num_var)+1} if
\code{cutoff = TRUE}), then sequences by \code{interval}.
\item Labels are derived from the numeric breaks and formatted as
\code{"a-b"} (with \code{b} shown as \code{b-1} when \code{right = FALSE}, to reflect
\verb{[a, b)} semantics). \code{"open"} variants replace the first/last label
with \code{"-b"} / \code{"a-"} respectively.
\item The resulting band column is an \strong{ordered factor}.
}
}
\examples{
\donttest{
# Basic: 5-year bands, left-closed intervals
df <- mtcars
add_band(df, hp)

# Custom width and right-closed intervals
add_band(df, mpg, interval = 10, right = TRUE, col_nm = "mpg_band")

# Provide explicit cut points
add_band(df, disp, breaks = c(0, 150, 250, 400, 600))

# Open-ended labels at both ends
add_band(df, qsec, interval = 2, label_style = "open")
}

}
